CREATE TABLE IF NOT EXISTS ideas (
  id INT AUTO_INCREMENT PRIMARY KEY,
  title TEXT NOT NULL,
  description TEXT,
  votes INT NOT NULL DEFAULT 0
);

CREATE TABLE IF NOT EXISTS votes (
  id INT AUTO_INCREMENT PRIMARY KEY,
  idea_id INT NOT NULL,
  ip VARCHAR(45) NOT NULL,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  UNIQUE KEY unique_vote (idea_id, ip),
  FOREIGN KEY (idea_id) REFERENCES ideas(id) ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS ip_vote_counters (
  ip VARCHAR(45) PRIMARY KEY,
  cnt INT NOT NULL DEFAULT 0
);

CREATE INDEX idx_votes_ip ON votes(ip);
CREATE INDEX idx_votes_idea ON votes(idea_id);

INSERT INTO ideas (title, description, votes) VALUES
('Адаптивная учебная траектория', 'Динамическая система, которая подстраивает уровни задач, темп и повторение под каждого ребёнка — на основе прогресса, времени решения и типов ошибок. Поддержка персональных целей и «микро-курсов» для усиления слабых мест.', 10),
('Пути мастерства (Mastery Paths)', 'Игровые квесты с ветвящейся системой достижений: чтобы пройти дальше, нужно продемонстрировать мастерство в связанных логических навыках. Интеграция с наградами, аватарами и видимыми прогресс-лентами.', 9),
('Кооперативные головоломки в реальном времени', 'Командные задачки и мини-игры, где дети решают логические головоломки вместе (2–4 игрока). Режимы: кооперация, соревнование, тренировка роли (например, навигатор/решатель).', 8),
('Дашборд для родителей и учителей', 'Подробные отчеты о прогрессе: навыки, типы ошибок, рекомендованные занятия, маршруты для домашней работы. Включить советы по поддержке ребёнка и экспорт в PDF/печать.', 8),
('AI-объяснения «почему»', 'Генератор понятных объяснений и подсказок на основе ИИ: пошаговое разбор решения, альтернативные подходы и аналогии, адаптированные под возраст и уровень ребёнка.', 8),
('Кампании с сюжетной линией', 'Сезонные/темативные сюжетные кампании, где каждое задание — эпизод истории. Выполнение задач открывает следующие главы, персонажей и мини-игры — удержание через нарратив.', 8),
('Режим «Создатель задач»', 'Инструмент для детей и учителей создавать свои головоломки и делиться ими в сообществе. Рейтинг лучших авторов, возможность модерации и соревновательные марафоны.', 8),
('Лиги и турниры', 'Регулярные турниры — индивидуальные и командные — с рейтингами, дивизионами и наградами. Турниры можно настроить для классов/школ или открытые глобальные события.', 8),
('Кросс-предметные модули', 'Задачи, которые объединяют логику с математикой, программированием, языками и наукой. Проекты-кейсы: оптимизация маршрута, расшифровка кодов, логика в биологии и т.д.', 8),
('Микроуроки по 3–7 минут', 'Короткие ежедневные задания и объяснения для повышения вовлечённости: «утренние разминки», «вечерние челленджи», пуш-напоминания и streak-система.', 8),
('Визуальное программирование для мышления', 'Блок-схемы и визуальные скрипты, где дети решают логические задачи, создавая последовательности действий — мост к изучению реального программирования.', 8),
('Интерфейс под характер ребёнка', 'Персонализация интерфейса (тон подсказок, скорость прогрессии, награды) в зависимости от типа мотивации ребёнка: исследователь, коллекционер, соревнователь и т.д.', 7),
('Оффлайн-режим с синхронизацией', 'Возможность играть без интернета и автоматически синхронизировать прогресс при подключении. Подходит для школ и регионов с ограниченным покрытием.', 6),
('Пакет аналитики для образования', 'Агрегированные, анонимные датасеты и инструменты для исследования обучения: траектории усвоения навыков, временные метки ошибок, контроль качества контента (с экспортом для исследований).', 5),
('Экосистема мотивации: питомцы и миры', 'Игровая система прогресса, где успехи оживляют виртуального питомца или развивают мир — косметические предметы, «строения знаний» и коллекции за пройденные навыки.', 2),
('Доступность и инклюзия', 'Набор функций для детей с особыми образовательными потребностями: аудио-режимы, увеличенный шрифт, упрощённые интерфейсы, адаптивные таймеры и поддержка ассистивных технологий.', 0);
